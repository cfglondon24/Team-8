<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Page Image</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        body {
            background-image :url_for('static', filename='logo-words.jpeg');
            background-size: cover;
            background-position: center;
        }
        .menu-bar {
            background-color: #333;
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .menu-left {
            display: flex;
            align-items: center;
        }
        .menu-right {
            display: flex;
            align-items: center;
        }
        .logo {
            margin-right: auto; /* Pushes logo box to the left */
        }
        .menu-bar a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .menu-bar a:hover {
            background-color: #555;
        }

/* Button used to open the chat form - fixed at the bottom of the page */
.open-button {
  background-color: #555;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  opacity: 0.8;
  position: fixed;
  bottom: 23px;
  right: 28px;
  width: 280px;
}

/* The popup chat - hidden by default */
.chat-popup {
  display: none;
  position: fixed;
  bottom: 0;
  right: 15px;
  border: 3px solid #f1f1f1;
  z-index: 9;
}


/* Add styles to the form container */
.form-container {
  max-width: 300px;
  padding: 10px;
  background-color: white;
}

/* Full-width textarea */
.form-container textarea {
  width: 100%;
  padding: 15px;
  margin: 5px 0 22px 0;
  border: none;
  background: #f1f1f1;
  resize: none;
  min-height: 200px;
}

/* When the textarea gets focus, do something */
.form-container textarea:focus {
  background-color: #ddd;
  outline: none;
}

/* Set a style for the submit/send button */
.form-container .btn {
  background-color: #04AA6D;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  width: 100%;
  margin-bottom:10px;
  opacity: 0.8;
}

/* Add a red background color to the cancel button */
.form-container .cancel {
  background-color: red;
}

/* Add some hover effects to buttons */
.form-container .btn:hover, .open-button:hover {
  opacity: 1;
}



@keyframes fadeIn {
    from { opacity: 0; transform: translate(-50%, -45%); }
    to { opacity: 1; transform: translate(-50%, -50%); }
}

.mood-form {
    background-color: #f8f9fa; /* Lighter and softer background color */
    padding: 30px;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 360px; /* Adjusted width for better layout */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
    border-radius: 12px;
    z-index: 10;
    font-family: 'Arial', sans-serif;
    animation: fadeIn 1s;
}

.score-options {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 20px; /* Space between sections */
}

.mood-btn {
    background-color: #ffffff; /* Default white background */
    border: none;
    border-radius: 25px; /* More pronounced rounded corners */
    padding: 12px 24px;
    margin: 6px;
    cursor: pointer;
    transition: all 0.3s; /* Smooth transition for all changes */
    color: #333;
    font-weight: bold;
    width: 100%; /* Full width for better touch interaction */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Subtle shadow for depth */
    text-align: center;
}

.mood-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

/* Gradient and hover effects */
.mood-btn[data-mood="Very Unpleasant"]:hover { background: linear-gradient(to right, #FFC2C2, #FFDADA); color: white; }
.mood-btn[data-mood="Unpleasant"]:hover { background: linear-gradient(to right, #FFD9C2, #FFE9DA); }
.mood-btn[data-mood="Neutral"]:hover { background: linear-gradient(to right, #FFEDC2, #FFFADA); }
.mood-btn[data-mood="Pleasant"]:hover { background: linear-gradient(to right, #E4FFC2, #F1FFDA); }
.mood-btn[data-mood="Very Pleasant"]:hover { background: linear-gradient(to right, #C2FFC2, #DAFFDA); }

.input-field {
    width: calc(100% - 20px);
    padding: 15px;
    margin: 15px 0;
    border: 1px solid #ccc;
    border-radius: 8px;
    display: block; /* Ensure it's always visible if needed */
    transition: all 0.3s;
}

.input-field, .submit-btn {
    display: none; /* Initially hidden */
}

.input-field.show, .submit-btn.show {
    display: block; /* Show only after specific actions */
}


.input-field:focus {
    border-color: #80bdff;
    outline: none;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
}

.submit-btn {
    background-color: #E4FFC2;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    width: 100%;
    transition: background-color 0.3s, transform 0.2s;
}

.submit-btn:hover {
    background-color: #E4FFC2;
    transform: translateY(-2px);
}


</style>
</head>
<body>
    <div class="menu-bar">
        <div class="menu-left">
            <div class="logo"> <!-- Logo box -->
                <img src="{{ url_for('static', filename='logo-words.jpeg') }}" alt="Logo" height="40px"> 

            </div>
        </div>
        <div class="menu-right">
            <a href="/">Home</a>
            <a href="/forum">Forum</a>
            <a href="/cognitive_game">Game</a>
            <a href="/friends">Friends</a>
            <a href="/profile">Profile</a>
        </div>
    </div>

    
    
    <form id="moodForm" action="/submit_mood" method="POST">
        <div class="mood-form">
            <h2>How are you feeling today?</h2>
            <div id="emotionalScore" class="score-options">
                <span>Select your emotional mood:</span>
                <button type="button" class="mood-btn" data-mood="Very Unpleasant" onclick="selectMood('emotional', 'Very Unpleasant')">Very Unpleasant</button>
                <button type="button" class="mood-btn" data-mood="Unpleasant" onclick="selectMood('emotional', 'Unpleasant')">Unpleasant</button>
                <button type="button" class="mood-btn" data-mood="Neutral" onclick="selectMood('emotional', 'Neutral')">Neutral</button>
                <button type="button" class="mood-btn" data-mood="Pleasant" onclick="selectMood('emotional', 'Pleasant')">Pleasant</button>
                <button type="button" class="mood-btn" data-mood="Very Pleasant" onclick="selectMood('emotional', 'Very Pleasant')">Very Pleasant</button>
            </div>
            <div id="cognitiveScore" class="score-options" style="display:none;">
                <span>Select your cognitive mood:</span>
                <button type="button" class="mood-btn" data-mood="Very Unpleasant" onclick="selectMood('cognitive', 'Very Unpleasant')">Very Unpleasant</button>
                <button type="button" class="mood-btn" data-mood="Unpleasant" onclick="selectMood('cognitive', 'Unpleasant')">Unpleasant</button>
                <button type="button" class="mood-btn" data-mood="Neutral" onclick="selectMood('cognitive', 'Neutral')">Neutral</button>
                <button type="button" class="mood-btn" data-mood="Pleasant" onclick="selectMood('cognitive', 'Pleasant')">Pleasant</button>
                <button type="button" class="mood-btn" data-mood="Very Pleasant" onclick="selectMood('cognitive', 'Very Pleasant')">Very Pleasant</button>
            </div>
            <div id="physicalScore" class="score-options" style="display:none;">
                <span>Select your physical mood:</span>
                <button type="button" class="mood-btn" data-mood="Very Unpleasant" onclick="selectMood('physical', 'Very Unpleasant')">Very Unpleasant</button>
                <button type="button" class="mood-btn" data-mood="Unpleasant" onclick="selectMood('physical', 'Unpleasant')">Unpleasant</button>
                <button type="button" class="mood-btn" data-mood="Neutral" onclick="selectMood('physical', 'Neutral')">Neutral</button>
                <button type="button" class="mood-btn" data-mood="Pleasant" onclick="selectMood('physical', 'Pleasant')">Pleasant</button>
                <button type="button" class="mood-btn" data-mood="Very Pleasant" onclick="selectMood('physical', 'Very Pleasant')">Very Pleasant</button>
            </div>
            <input type="hidden" id="emotionalScoreInput" name="emotionalScore">
            <input type="hidden" id="cognitiveScoreInput" name="cognitiveScore">
            <input type="hidden" id="physicalScoreInput" name="physicalScore">
            <textarea id="moodMessage" class="input-field" name="moodMessage" placeholder="Share your thoughts..." style="display:none;"></textarea>
            <button type="submit" class="submit-btn" style="display:none;">Submit</button>
        </div>
    </form>
    
    


    <button class="open-button" onclick="openChat()">Open Chat</button>
    
    
    <div id="chatPopup" class="chat-popup">
        <div class="form-container">
            <div id="chatMessages" class="chat-messages"></div>
            <textarea id="messageInput" placeholder="Type your message..."></textarea>
            <button class="btn" onclick="sendMessage()">Send</button>
            <button class="btn cancel" onclick="closeChat()">Close</button>
        </div>
    </div>


    <script>
        function openChat() {
            document.getElementById("chatPopup").style.display = "block";
        }

        function closeChat() {
            document.getElementById("chatPopup").style.display = "none";
        }

        function sendMessage() {
            var message = document.getElementById("messageInput").value;
            if (message.trim() !== "") {
                displayMessage(message, "user");
                // Simulate a response from the chat bot
                setTimeout(function() {
                    displayMessage(analyzeMessage(message), "bot");
                }, 1000);
                document.getElementById("messageInput").value = "";
            }
        }

        function submitMood() {
            var moodScore = document.getElementById("moodScore").value;
            var moodMessage = document.getElementById("moodMessage").value;
            if (moodScore.trim() !== "" && moodMessage.trim() !== "") {

                console.log("Mood Score: " + moodScore + ", Message: " + moodMessage);

                document.getElementById("moodScore").value = "";
                document.getElementById("moodMessage").value = "";
                alert("Thank you for sharing how you feel.");
            } else {
                alert("Please fill in both fields.");
            }
        }
        

    function selectMood(category, mood) {
        const scoreMap = { 'Very Unpleasant': 1, 'Unpleasant': 2, 'Neutral': 3, 'Pleasant': 4, 'Very Pleasant': 5 };
        document.getElementById(`${category}ScoreInput`).value = scoreMap[mood];

        if (category === 'emotional') {
            document.getElementById('emotionalScore').style.display = 'none';
            document.getElementById('cognitiveScore').style.display = 'block';
        } else if (category === 'cognitive') {
            document.getElementById('cognitiveScore').style.display = 'none';
            document.getElementById('physicalScore').style.display = 'block';
        } else if (category === 'physical') {
            document.getElementById('physicalScore').style.display = 'none';
            document.getElementById('moodMessage').style.display = 'block';
            document.querySelector('.submit-btn').style.display = 'block';
        }
    }




        function analyzeMessage(message) {
            // We want to go through the message and look for certain keywords and recommend either pages or phone numbers based on this response
            var distressList = ["urgently", "scared", "depressed"];
            var aboutList = ["learn", "educate", "about"];
            var legalList = ["legal", "work", "office", "boss"]
            var aboutPageURL = "about.html"; 

            for (var i = 0; i < distressList.length; i++) {
                if (message.includes(distressList[i])) {
                    return "We feel like you will be better suited to speak to someone on the phone. Please call 0800 389 6255."
                }
            }

            for (var i = 0; i < aboutList.length; i++) {
                if (message.includes(aboutList[i])) {
                    var messageWithLink = "You seem to want to learn more about our charity, please visit our about page to learn more";
                    return messageWithLink;
                }
            }

            for (var i = 0; i < legalList.length; i++) {
                if (message.includes(legalList[i])) {
                    return "We feel like you will be better suited to speak to someone on the phone. Please contact anyone of our legal partners: Anthony Collins (0121 212 7476), Enable Law (0800 044 8488), irwinmitchell (08000 23 22 33), fletchers group (01704 503126)"
                }
            }

            return "This is a generic response from our chat bot for further support please contact us on: 08003896255";
        }


        function displayMessage(message, sender) {
            var chatMessages = document.getElementById("chatMessages");
            var messageElement = document.createElement("div");
            messageElement.classList.add("message");
            messageElement.classList.add(sender);
            messageElement.innerText = message;
            chatMessages.appendChild(messageElement);
        }
    </script>

    
</body>
</html>
